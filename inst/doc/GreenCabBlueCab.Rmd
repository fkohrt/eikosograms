---
title: "Green cab, blue cab"
header-includes:
- \usepackage{graphicx}
- \usepackage{epic}
- \usepackage{color}
- \usepackage{hyperref}
- \usepackage{multimedia}
- \PassOptionsToPackage{pdfmark}{hyperref}\RequirePackage{hyperref}
- \pgfdeclareimage[height=0.12\textheight]{university-logo}{../../UWlogo.png}
- \logo{\pgfuseimage{university-logo}}
- \newcommand{\code}[1]{\texttt{#1}}
- \newcommand{\ve}[1]{\mathbf{#1}}
- \newcommand{\pop}[1]{\mathcal{#1}}
- \newcommand{\samp}[1]{\mathcal{#1}}
- \newcommand{\subspace}[1]{\mathcal{#1}}
- \newcommand{\sv}[1]{\boldsymbol{#1}}
- \newcommand{\sm}[1]{\boldsymbol{#1}}
- \newcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}
- \newcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}
- \newcommand{\size}[1]{\left\lvert {#1} \right\rvert}
- \newcommand{\norm}[1]{\left|\left|{#1}\right|\right|}
- \newcommand{\field}[1]{\mathbb{#1}}
- \newcommand{\Reals}{\field{R}}
- \newcommand{\Integers}{\field{Z}}
- \newcommand{\Naturals}{\field{N}}
- \newcommand{\Complex}{\field{C}}
- \newcommand{\Rationals}{\field{Q}}
- \newcommand{\widebar}[1]{\overline{#1}}
- \newcommand{\wig}[1]{\tilde{#1}}
- \newcommand{\bigwig}[1]{\widetilde{#1}}
- \newcommand{\leftgiven}{~\left\lvert~}
- \newcommand{\given}{~\vert~}
- \newcommand{\indep}{\bot\hspace{-.6em}\bot}
- \newcommand{\notindep}{\bot\hspace{-.6em}\bot\hspace{-0.75em}/\hspace{.4em}}
- \newcommand{\depend}{\Join}
- \newcommand{\notdepend}{\Join\hspace{-0.9 em}/\hspace{.4em}}
- \newcommand{\imply}{\Longrightarrow}
- \newcommand{\notimply}{\Longrightarrow \hspace{-1.5em}/ \hspace{0.8em}}
- \newcommand*{\intersect}{\cap}
- \newcommand*{\union}{\cup}
- \DeclareMathOperator*{\argmin}{arg\,min}
- \DeclareMathOperator*{\argmax}{arg\,max}
- \DeclareMathOperator*{\Ave}{Ave\,}
- \newcommand{\suchthat}{~:~}
- \newcommand{\st}{~:~} 
- \newcommand{\permpause}{\pause}
author: "R. W. Oldford"
date: '`r Sys.Date()`'
output:
  html_document:
    number_sections: no
    toc: yes
  html_notebook: default
  html_vignette:
    number_sections: no
    toc: yes
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
    number_sections: no
    toc: yes
  word_document: default
vignette: |
  %\VignetteIndexEntry{Introduction} 
  %\VignetteEngine{knitr::rmarkdown} 
  %\VignetteEncoding{UTF-8}
  

---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
set.seed(12314159)
```

---

$\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}$
$\renewcommand{\ve}[1]{\mathbf{#1}}$
$\renewcommand{\sv}[1]{\boldsymbol{#1}}$
$\renewcommand{\pop}[1]{\mathcal{#1}}$
$\renewcommand{\samp}[1]{\mathcal{#1}}$
$\renewcommand{\imply}{\Longrightarrow}$
$\renewcommand{\given}{~\vert~}$
$\renewcommand{\suchthat}{~:~}$
$\renewcommand{\widebar}[1]{\overline{#1}}$
$\renewcommand{\wig}[1]{\tilde{#1}}$
$\renewcommand{\bigwig}[1]{\widetilde{#1}}$
$\renewcommand{\field}[1]{\mathbb{#1}}$
$\renewcommand{\Reals}{\field{R}}$
$\renewcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}$
$\renewcommand{\size}[1]{\left\lvert {#1} \right\rvert}$
$\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}$
$\renewcommand{\norm}[1]{\left|\left|{#1}\right|\right|}$
$\renewcommand{\intersect}{\cap}$
$\renewcommand{\union}{\cup}$

```{r libraries}
library(eikosograms)
```

# The problem

The following problem was first introduced by 
Kahneman and Tversky (1972) reproduced below from Tversky and Kahneman (1982, pp. 156-157).

> A cab was involved in a hit and run accident at night. Two cab companies, the Green and Blue, operate in the city. 
>
>You are given the following data:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(a) 85% of the cabs in the city are Green and 15% are Blue.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b) a witness identified the cab as Blue.  
The court tested the reliability of the witness under the same circumstances that existed on the night of the accident and concluded that the witness correctly identified each one of the two colors 80% of the time and failed 20% of the time.
>
>What is the probability that the cab involved in the accident was Blue rather than Green? 

There, they report that the
median and modal answers given by these subjects is typically 0.80, exactly the
probability  that the witness correctly identifies the cab colour in
the test situations.  

Knowing that the witness has been demonstrated to
be right 80\% of the time, both when the cab is Green and when the cab is Blue,
it would seem to many of these potential jurors that the cab has probability of 0.80
of being whatever colour the witness says it was.  The distribution of the cabs in the
city seems to have been deemed irrelevant.

That this is not the case might have been more easily seen had the information been
presented visually.

# Information given as an eikosogram
The following eikosogram shows the information that was given in the problem

```{r cab data, echo=TRUE, message=FALSE, fig.align="center", fig.width=4, fig.height=3.5, out.width ="50%"}
HitAndRun <- as.table(array(c(12, 17, 3, 68), 
                            dim = c(2,2),
                            dimnames = list(
                                Cab = c("Blue", "Green"), 
                                Witness = c("Blue", "Green"))
                            )
                      )

eikos(y = "Witness", x = "Cab", data = HitAndRun, 
      bottomcol = "grey")
```

An examination of this eikosogram shows that it is faithful to the facts as described.  The horizontal or conditioning variate is the actual colour of cabs in the city. As the widths show, 15\% of these are blue, and 85\% are green.  

The conditional probabilities show the reliability of the eye witness account.  At left, if the witness is shown a blue car, they will correctly identify it as blue with probability 0.80 or 80\% of the time.  Similarly, at right if the witness is presented with a green coloured cab, they will mis-identify it as blue with probability 0.2 or 20\% of the time and will correctly identify it as green 80 \% of the time.

# The solution

Of course, the conditional probabilities above are not those which should be of interest.  The eikosogram makes this clear, the first vertical height of 0.8 for the darker grey bar at left is seen to be (reading left to right) the conditional probability that the witness says the cab is blue given that it is blue.

But this is not the probability of interest!  Rather it is the probability that the cab is blue given that the witness said it was blue.  The correct eikosogram is had from the same data as

```{r cab solution, echo=TRUE, message=FALSE, fig.align="center", fig.width=4, fig.height=3, out.width ="50%"}
eikos(y = "Cab", x = "Witness", data = HitAndRun, 
      bottomcol = "grey")
```

Reading the desired probability from this eikosogram, we see that the probability that the cab is blue given that the witness said it was blue is only 0.41, nearly half the probability that Kahneman and Tversky found to be the most popular value suggested by their subjects!!