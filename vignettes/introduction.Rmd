---
title: "Introduction to Eikosograms"
header-includes:
- \usepackage{graphicx}
- \usepackage{epic}
- \usepackage{color}
- \usepackage{hyperref}
- \usepackage{multimedia}
- \PassOptionsToPackage{pdfmark}{hyperref}\RequirePackage{hyperref}
- \pgfdeclareimage[height=0.12\textheight]{university-logo}{../../UWlogo.png}
- \logo{\pgfuseimage{university-logo}}
- \newcommand{\code}[1]{\texttt{#1}}
- \newcommand{\ve}[1]{\mathbf{#1}}
- \newcommand{\pop}[1]{\mathcal{#1}}
- \newcommand{\samp}[1]{\mathcal{#1}}
- \newcommand{\subspace}[1]{\mathcal{#1}}
- \newcommand{\sv}[1]{\boldsymbol{#1}}
- \newcommand{\sm}[1]{\boldsymbol{#1}}
- \newcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}
- \newcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}
- \newcommand{\size}[1]{\left\lvert {#1} \right\rvert}
- \newcommand{\norm}[1]{\left|\left|{#1}\right|\right|}
- \newcommand{\field}[1]{\mathbb{#1}}
- \newcommand{\Reals}{\field{R}}
- \newcommand{\Integers}{\field{Z}}
- \newcommand{\Naturals}{\field{N}}
- \newcommand{\Complex}{\field{C}}
- \newcommand{\Rationals}{\field{Q}}
- \newcommand{\widebar}[1]{\overline{#1}}
- \newcommand{\wig}[1]{\tilde{#1}}
- \newcommand{\bigwig}[1]{\widetilde{#1}}
- \newcommand{\leftgiven}{~\left\lvert~}
- \newcommand{\given}{~\vert~}
- \newcommand{\indep}{\bot\hspace{-.6em}\bot}
- \newcommand{\notindep}{\bot\hspace{-.6em}\bot\hspace{-0.75em}/\hspace{.4em}}
- \newcommand{\depend}{\Join}
- \newcommand{\notdepend}{\Join\hspace{-0.9 em}/\hspace{.4em}}
- \newcommand{\imply}{\Longrightarrow}
- \newcommand{\notimply}{\Longrightarrow \hspace{-1.5em}/ \hspace{0.8em}}
- \newcommand*{\intersect}{\cap}
- \newcommand*{\union}{\cup}
- \DeclareMathOperator*{\argmin}{arg\,min}
- \DeclareMathOperator*{\argmax}{arg\,max}
- \DeclareMathOperator*{\Ave}{Ave\,}
- \newcommand{\suchthat}{~:~}
- \newcommand{\st}{~:~} 
- \newcommand{\permpause}{\pause}
author: "R. W. Oldford"
date: '`r Sys.Date()`'
output:
  html_document:
    number_sections: no
    toc: yes
  html_notebook: default
  html_vignette:
    number_sections: no
    toc: yes
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
    number_sections: no
    toc: yes
  word_document: default
vignette: |
  %\VignetteIndexEntry{Introduction} 
  %\VignetteEngine{knitr::rmarkdown} 
  %\VignetteEncoding{UTF-8}
  

---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
set.seed(12314159)
```

---

$\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}$
$\renewcommand{\ve}[1]{\mathbf{#1}}$
$\renewcommand{\sv}[1]{\boldsymbol{#1}}$
$\renewcommand{\pop}[1]{\mathcal{#1}}$
$\renewcommand{\samp}[1]{\mathcal{#1}}$
$\renewcommand{\imply}{\Longrightarrow}$
$\renewcommand{\given}{~\vert~}$
$\renewcommand{\suchthat}{~:~}$
$\renewcommand{\widebar}[1]{\overline{#1}}$
$\renewcommand{\wig}[1]{\tilde{#1}}$
$\renewcommand{\bigwig}[1]{\widetilde{#1}}$
$\renewcommand{\field}[1]{\mathbb{#1}}$
$\renewcommand{\Reals}{\field{R}}$
$\renewcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}$
$\renewcommand{\size}[1]{\left\lvert {#1} \right\rvert}$
$\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}$
$\renewcommand{\norm}[1]{\left|\left|{#1}\right|\right|}$
$\renewcommand{\intersect}{\cap}$
$\renewcommand{\union}{\cup}$

Eikosograms are drawn using the grid graphics package:
```{r}
library(grid)
library(gridExtra)
```

# A picture of probability

The word **eikosogram** is constructed by joining two ancient Greek words:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*eikos*: like truth, likely, probable, reasonable, probability, likelihood  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*gramma*: that which is drawn, picture, piece of writing  

```{r eikos library, echo = TRUE, fig.width=4, fig.height=3, fig.align="center", out.width="50%"}
library(eikos)
```

As the name suggests, an **eikosogram** is a **picture of probability**. It visually partitions a unit square into rectangular regions whose areas give the numerical values of various probabilities. The construction is such that each rectangular region is identified with the value of one or more categorical variates.

For example, consider the probability that an application  for admission to university is accepted.  Different universities and programs of study can have different admission rates.  For example, in 2017 there were about 15,200 applications to the Faculty of Mathematics at the University of Waterloo for only 1200 first year places, suggesting the probability that an application is accepted is about `r round(1200/15200, 2)`.  Suppose this to be the case, then the eikosogram representing the application process is given by
```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, fig.width=4, fig.height=3, fig.align="center", out.width="50%", fig.cap = "Application to Waterloo's Faculty of Mathematics (2017)"}
Waterloo <- data.frame(Decision = c(rep("Accepted", 1200), 
                                    rep("Rejected", 15200-1200)))
eikos("Decision", data = Waterloo)
```

Only two decisions are possible --  an application is either accepted (and an offer of admission made) or it is rejected, as identified by the abels on the left side of eikosogram.  On the right side of the eikosogram a single number appears, `r round(sum(Waterloo$Decision == "Accepted")/nrow(Waterloo), 2)`, marking the vertical height of the bottom (blue) rectangle.

An eikosogram always has unit area (whatever its aspect ratio) and represents the  totality of its probability with each side of the eikosogram extending from 0 to 1.  The bottom (blue) rectangle is associated with the event that an application is accepted and its area the probability of acceptance.  This probability is determined by simply calculating this area from the eikosogram as
\[ 
\begin{array}{rcl}
Pr(Decision = Accepted) & = & width \times height  \\
&& \\
& = & 1 \times 0.08  \\
&& \\
& = & 0.08
\end{array}
\]
Since `Decision` is a binary variate, the top (grey) rectangle is associated with the application being rejected.  The area of this rectangle is the probability
\[ 
\begin{array}{rcl}
Pr(Decision = Rejected) & = & width \times height  \\
&& \\
& = & 1 \times (1 - 0.08)  \\
&& \\
& = & 0.92 .
\end{array}
\]
These two areas give the probability distribution of the binary random variate `Decision` whose value must be one of $\{Accepted, ~Rejected \}$.  The eikosogram gives a visual representation of this probability distribution; the relative areas visually convey the magnitude of the probabilities.  Moreover, since the width of both rectangles is the same (viz. 1) these probabilities are also given more simply (and visually more accurately) by the heights of the two rectangles.


# Grad admissions to Berkeley (1973)

A well known data set in `R` is `UCBAdmissions` which recorde the number of applications and admissions to several large graduate at the University of California (Berkeley) in 1973.  This is a table of counts cross classified by three different factors:
```{r Berkeley table, echo = FALSE}
str(UCBAdmissions)
```

The `eikos()` function is used to produce the eikosogram showing the probability of admission, 
```{r UCB admissions, echo = TRUE, fig.width=4, fig.height=3, fig.align="center", out.width="50%"}
eikos("Admit", data = UCBAdmissions)
```

The proportion of applications admitted to these graduate programs at Berkeley in 1973 was 0.39.  The probability of an application being admitted is represented by the area (or height) of the bottom (blue) rectangle and the probability of rejection by the area (or height) of the top (grey) rectangle which is 1 - 0.39 = 0.61. 

The first argument to `eikos()` is the `y` or "response" variate and determines the positions on the vertical axis.  There will be as many horizontal rectangles stacked up the vertical axis as there are distinct values for `y`.   For example, the probability that any application is submitted to each of the six graduate departments is
```{r UCB departments, echo = TRUE, fig.width=4, fig.height=3, fig.align="center", out.width="50%"}
eikos("Dept", data = UCBAdmissions)
```

Again, areas correspond to probabilities and can be determined in this case from each rectangle's height (since widths are all 1).  The probability that a randomly selected application was submitted to Department `A` is 0.21, to `B` is 0.13 (= 0.34 - 0.21), to `C` is 0.20  (= 0.54 - 0.34), to `D` is 0.17  (= 0.71 - 0.54), to `E` is 0.13  (= 0.84 - 0.71), and finally to `F` is 0.16  (= 1 - 0.84).  

# Conditional and marginal probabilites

The eikosogram reinforces the basic probability rule that when the values of the variate are mutually exclusive and exhaust the set of possibilities, the probabilities must sum to one:
\[Pr(Dept = A) + Pr(Dept = B) + \cdots + Pr(Dept = F) = 1 \]
Note that this was because not all Berkeley departments are being considered here; these probabilities are therefore *conditional* on the fact that the department is one of the six largest.  

In a very direct sense, the unit square of the eikosogram *frames* the probabilities expressed within it and these are **always conditional on whatever background information determines the unit square**.  

For example, in addition to considering only the six largest departments, we could also restrict consideration by sex. The number of applications from each gender is 
```{r UCB gender marginals, echo = TRUE, fig.width=4, fig.height=3.5, fig.align="center", out.width="50%"}
eikos("Gender", data = UCBAdmissions)
```

showing that there are unequal numbers of applications from each sex with $Pr(Gender = Male) = 0.59$ and $Pr(Gender = Female) = 0.41$.

The eikosogram conditional only on "Male" applicants is
```{r UCB Dept by male, echo = TRUE, fig.width=4, fig.height=3.5, fig.align="center", out.width="50%"}
eikos("Dept", data = UCBAdmissions[,"Male",], 
      main = "Applications from males")
```

Probabilities can be determined as before but we can see immediately from the eikosogram that departments `A` and `B` are the most popular departments for male applicants, more so than for all applications combined (in the previous histogram).

Conditioning on the "Female" applications
```{r UCB Dept by female, echo = TRUE, fig.width=4, fig.height=3.5, fig.align="center", out.width="50%"}
eikos("Dept", data = UCBAdmissions[,"Female",], 
      main = "Applications from females")
```

we see a rather different distribution of probabilities.  Departments `A` and `B` are much less popular with female applicants than with male (e.g. only 1 in 100 applications from females are to `B` compared to 1 in 5 for males).  Instead departments `C` and `E` are much more likely to receive an application if it is from a female than if it is from a male.

Knowing the marginal probabilities that an application is from a female or a male, we might put these two eikosograms together in a single eikosogram.
```{r UCB Dept by gender, echo = TRUE, fig.width=4, fig.height=3, fig.align="center", out.width="50%"}
eikos(y = "Dept", x = "Gender",  data = UCBAdmissions,
      label_size = 8)
```

As can be seen the two conditional eikosograms are now fitted into the unit square, the width of each being the marginal probability of that conditioning variable "Gender".   

The conditioning variate values appear along the bottom horsizontal edge of the eikosogram and the corresponding probability appears along the top.  The probability that an application is from a male applicant is 0.59 and from a female applicatant 0.41 = 1 - 0.59.  

Along the right hand vertical axis are values associated with conditional probabilities for each department's applications given gender.  For every horizontal line in the plot, cumulative probability to that height is given.  The height of each bar now corresponds to the conditional probability of an application to that department given the corresponding gender.  These can be computed as the difference between the corresponding values on the vertical axis.  For example, the probability of an application being to department `E` is 0.21 = 0.81 - 0.6 given the gender is "Female" and is one third of that, or 0.07 = 0.86 - 0.79,  if the gender is "Male".


# Geometry and probability.

The power of the eikosogram is that its **geometry embeds the probabilities** of discrete random variates:

- the unit area of the whole eikosogram is the total probability,
- widths of rectangles are marginal probabilities
- heights of rectangles are conditional probabilities
- areas of rectangles are joint probabilities
- the vertical axis shows the values of the **response** variate
- the horizontal axis shows the values of the **explanatory** or **conditioning** variate(s)
- the width of the vertical bar is also the area of that bar and hence the sum of the areas of the rectangles it contains
- the width of any vertical bar is the marginal probability of that value of the conditioning variate

An eikosogram divides the unit square into vertical bars according to the proportion for each value of one variate (the "conditioning" variate), and then divides each vertical bar horizontally into rectangles whose heights are proportional to the each value of the second variate (the "response" variate) given the value of the first (that which defined the vertical bar's width). The area of every rectangle is the joint probability of the corresponding values of the conditioning and reasponse variates.


# Bayes's theorem

The eikosogram gives the joint probability of the response and conditioning variates.  It highlights the marginal probabilities of the conditioning variate but not of the response variate, whose probabilities appear only as conditional.  The appearance of the eikosogram, and hence the joint distribution, can be different depending on which variates are the response and which are conditioned upon.

For example, consider again the probability of admission to Berkeley graduate school, but this time condition on the sex of the applicant.

```{r admit given gender, echo = TRUE, fig.width=4, fig.height=3, fig.align="center", out.width="50%"}
eikos(y = "Admit", x = "Gender", data = UCBAdmissions)
```

For all applications, this shows the joint distribution of the variates `Admit` and `Gender`.  As can be seen, the probability of admission for male applicants is 0.45 and greater than that for female applicants (0.3).  The probability that an application is from a male is 0.59 and from a female 0.41 = 1 - 0.59.

The joint probability that an application is from a male and that it results in an offer of admission is the area of the bottom left rectangle or 

\[ 
\begin{array}{rcl}
Pr(Gender = \mbox{"Male"} ~~\& ~~Admit = \mbox{"Admitted"}) &=& \mbox{area of bottom left rectangle} \\
 &=& \mbox(height) \times \mbox{(width) of rectangle} \\
 &=& Pr(Admit = \mbox{"Admitted"} \given Gender = \mbox{"Male"})\\
 && ~~~~~~~~~~\times Pr(Gender = \mbox{"Male"} )\\
&=& 0.45 \times 0.59 \\
&=& 0.2655
\end{array}
\]
Similarly, the area of the bottom right rectangle is 
\[
\begin{array}{rcl}
Pr(Gender = \mbox{"Female"} ~~\& ~~Admit = \mbox{"Admitted"}) &=& Pr(Admit = \mbox{"Admitted"} \given Gender = \mbox{"Female"}) \\
 && ~~~~~~~~~~\times 
Pr(Gender = \mbox{"Female"} ) \\
& = & 0.3 \times 0.41 \\
&=& 0.123
\end{array}
\]
the area of the top left rectangle is 
\[
\begin{array}{rcl}
Pr(Gender = \mbox{"Male"} ~~\& ~~Admit = \mbox{"Rejected"}) &=& Pr(Admit = \mbox{"Rejected"} \given Gender = \mbox{"Male"}) \\
 && ~~~~~~~~~~\times 
Pr(Gender = \mbox{"Male"} ) \\
& = & (1 - 0.45) \times 0.59 \\
&=& 0.3245
\end{array}
\]
and finally the area of the top right rectangle is 
\[
\begin{array}{rcl}
Pr(Gender = \mbox{"Female"} ~~\& ~~Admit = \mbox{"Rejected"}) &=& Pr(Admit = \mbox{"Rejected"} \given Gender = \mbox{"Female"}) \\
 && ~~~~~~~~~~\times 
Pr(Gender = \mbox{"Female"} ) \\
& = & (1 - 0.3) \times (1 - 0.59) \\
&=& 0.287
\end{array}
\]
The sum of these four probabilities is of course 1.

Alternatively, the joint distribution of the variates `Admit` and `Gender` could be expressed by conditioning on the values or `Admit` rather than on those of `Gender`:

```{r gender given admit, echo = TRUE, fig.width=4, fig.height=3, fig.align="center", out.width="50%"}
eikos(y = "Gender", x = "Admit", data = UCBAdmissions)
```

Now we see that the conditional probability that the the gender of the applicant was male given the application was admitted is 0.68.  Given the application was rejected, the probability that the gender was male was only 0.54.  The other two conditional probabilities, of the applicant being female, given the application was admitted or rejected is 0.32 amd 0.46 respectively.

These two eikosograms **show the same joint distribution** and the four rectangles in each  **show the same joint probabilities**.  That is the bottom left rectangle of both eikosograms have the same variate values, namely the `Gender` = "Male" and `Admit` = "Admitted".  They must therefore have the same area.  In the first eikosogram, this area was 
\[ 
Pr(Admit = \mbox{"Admitted"} \given Gender = \mbox{"Male"}) \times Pr(Gender = \mbox{"Male"} )
\]
which is just $Pr(Admit = \mbox{"Admitted"} ~\&~ Gender = \mbox{"Male"}).
The same joint probability in the second eikosogram is the area of the corresponding rectangle
\[ 
Pr(Gender = \mbox{"Male"} \given Admit = \mbox{"Admitted"}) \times Pr(Admit = \mbox{"Admitted"}).
\]
That these two rectangles have the same area is the famous result due to the Thomas Bayes!  Namely that
\[ 
\begin{array}{rcl}
Pr(Admit = \mbox{"Admitted"} \given Gender = \mbox{"Male"}) &\times&  Pr(Gender = \mbox{"Male"} )\\
= ~~
Pr(Gender = \mbox{"Male"} \given Admit = \mbox{"Admitted"}) &\times& Pr(Admit = \mbox{"Admitted"}).
\end{array}
\]
Rectangles which identify the *same* joint probability in both histograms must have the same area.  This is Bayes's theorem and is perhaps most simply expressed generically as
\[Pr(Y \given X) \time Pr(X) = Pr(X ~\&~ Y) = Pr(X \given Y) \times Pr(Y). 
|]
Simply, areas of corresponding rectangles must match.

# Independence

Two random variates $X$ and $Y$  are said to be distributed **independently** of one another if their corresponding eikosgram is **flat**.

For example, consider the following eikosogram
```{r independence Y given X, echo = TRUE, fig.width=4, fig.height=3.5, fig.align="center", out.width="50%", fig.cap = "Independence of variates X and Y"}
indep <- as.table(array(c(10, 40, 15, 60),
                        dim = c(2,2),
                        dimnames = 
                        list(X =c("x_1", "x_2"), 
                             Y = c("y_1", "y_2"))))
eikos("Y", "X", data = indep)
```

Clearly, for $i = 1, 2$
\[Pr(Y = y_i \given X = x_1) = Pr(Y = y_i \given X = x_2) = Pr(Y = y_i)\]
This is what we mean by independence - whatever the value of $X$ the probability that $Y$ takes any particular value is the same.  $Y$'s values are independent of those of $X$.

By definition, this presents itself as all regions being flat across the values of the conditioning variate.

Of course, if we reverse the conditioning, flatness in the eikosogram must happen because of the independence. And this is what we see:
```{r independence X given Y, echo = TRUE, fig.width=4, fig.height=3.5, fig.align="center", out.width="50%", fig.cap = "Independence of variates X and Y"}
eikos("X", "Y", data = indep)
```
Now, for $i = 1, 2$
\[Pr(X = x_i \given Y = y_1) = Pr(X = x_i \given Y = y_2) = Pr(X = x_i).\]

It follows from either of these, and the definition  that a joint probability  is the area of the corresponding rectangle, that independence occurs if and only if for any $i$, $j$,
\[Pr(X = x_i ~\&~  Y = y_j) = Pr(X = x_i) \times Pr(Y = y_j).\]