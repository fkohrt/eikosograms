---
title: "Perceptions of probability"
subtitle: "Green cabs, blue cabs"
bibliography: eikosograms.bib
author: "R. Wayne Oldford"
date: '`r Sys.Date()`'
output:
  html_document:
    number_sections: no
    toc: yes
  html_notebook: default
  html_vignette:
    number_sections: no
    toc: yes
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
    number_sections: no
    toc: yes
  word_document: default
vignette: |
  %\VignetteIndexEntry{Introduction} 
  %\VignetteEngine{knitr::rmarkdown} 
  %\VignetteEncoding{UTF-8}
header-includes:
- \usepackage{graphicx}
- \usepackage{epic}
- \usepackage{color}
- \usepackage{hyperref}
- \usepackage{multimedia}
- \PassOptionsToPackage{pdfmark}{hyperref}\RequirePackage{hyperref}
- \pgfdeclareimage[height=0.12\textheight]{university-logo}{../../UWlogo.png}
- \logo{\pgfuseimage{university-logo}}
- \newcommand{\code}[1]{\texttt{#1}}
- \newcommand{\ve}[1]{\mathbf{#1}}
- \newcommand{\pop}[1]{\mathcal{#1}}
- \newcommand{\samp}[1]{\mathcal{#1}}
- \newcommand{\subspace}[1]{\mathcal{#1}}
- \newcommand{\sv}[1]{\boldsymbol{#1}}
- \newcommand{\sm}[1]{\boldsymbol{#1}}
- \newcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}
- \newcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}
- \newcommand{\size}[1]{\left\lvert {#1} \right\rvert}
- \newcommand{\norm}[1]{\left|\left|{#1}\right|\right|}
- \newcommand{\field}[1]{\mathbb{#1}}
- \newcommand{\Reals}{\field{R}}
- \newcommand{\Integers}{\field{Z}}
- \newcommand{\Naturals}{\field{N}}
- \newcommand{\Complex}{\field{C}}
- \newcommand{\Rationals}{\field{Q}}
- \newcommand{\widebar}[1]{\overline{#1}}
- \newcommand{\wig}[1]{\tilde{#1}}
- \newcommand{\bigwig}[1]{\widetilde{#1}}
- \newcommand{\leftgiven}{~\left\lvert~}
- \newcommand{\given}{~\vert~}
- \newcommand{\indep}{\bot\hspace{-.6em}\bot}
- \newcommand{\notindep}{\bot\hspace{-.6em}\bot\hspace{-0.75em}/\hspace{.4em}}
- \newcommand{\depend}{\Join}
- \newcommand{\notdepend}{\Join\hspace{-0.9 em}/\hspace{.4em}}
- \newcommand{\imply}{\Longrightarrow}
- \newcommand{\notimply}{\Longrightarrow \hspace{-1.5em}/ \hspace{0.8em}}
- \newcommand*{\intersect}{\cap}
- \newcommand*{\union}{\cup}
- \DeclareMathOperator*{\argmin}{arg\,min}
- \DeclareMathOperator*{\argmax}{arg\,max}
- \DeclareMathOperator*{\Ave}{Ave\,}
- \newcommand{\suchthat}{~:~}
- \newcommand{\st}{~:~} 
- \newcommand{\permpause}{\pause}
  

---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
set.seed(12314159)
```

---

$\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}$
$\renewcommand{\ve}[1]{\mathbf{#1}}$
$\renewcommand{\sv}[1]{\boldsymbol{#1}}$
$\renewcommand{\pop}[1]{\mathcal{#1}}$
$\renewcommand{\samp}[1]{\mathcal{#1}}$
$\renewcommand{\imply}{\Longrightarrow}$
$\renewcommand{\given}{~\vert~}$
$\renewcommand{\suchthat}{~:~}$
$\renewcommand{\widebar}[1]{\overline{#1}}$
$\renewcommand{\wig}[1]{\tilde{#1}}$
$\renewcommand{\bigwig}[1]{\widetilde{#1}}$
$\renewcommand{\field}[1]{\mathbb{#1}}$
$\renewcommand{\Reals}{\field{R}}$
$\renewcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}$
$\renewcommand{\size}[1]{\left\lvert {#1} \right\rvert}$
$\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}$
$\renewcommand{\norm}[1]{\left|\left|{#1}\right|\right|}$
$\renewcommand{\intersect}{\cap}$
$\renewcommand{\union}{\cup}$

```{r libraries}
library(eikosograms)
```

# The problem

@KahnemanTversky72 investigated human perception of probability by asking people to solve seemingly simple probability problems.  One of the more famous problems involved determining a probability of guilt in a court of law, based solely on the quantifiable empirical evidence that was presented.

Participants were given the following information, taken here from @TverskyKahneman1982EvidImpact pp. 156-157, and asked to find the correct probability:

> A cab was involved in a hit and run accident at night. Two cab companies, the Green and Blue, operate in the city. 
>
>You are given the following data:  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(a) 85% of the cabs in the city are Green and 15% are Blue.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(b) a witness identified the cab as Blue.  
The court tested the reliability of the witness under the same circumstances that existed on the night of the accident and concluded that the witness correctly identified each one of the two colors 80% of the time and failed 20% of the time.
>
>What is the probability that the cab involved in the accident was Blue rather than Green? 

The authors report that the
median and modal answers given by these subjects is typically 0.80, 
which is exactly the probability  that the witness correctly identifies the cab colour in the test situations.  

It would appear that knowing that the witness is right 80\% of the time, both when the cab is Green and when the cab is Blue, that the cab should also have probability of 0.80 of being whatever colour the witness says it was.  These potential jurors seem to have ignored the distribution of the cabs in the city, possibly as being irrelevant given the witness's identification of colour.

That this is not correct might have been more easily seen had the information been
presented visually.

## its picture

The probabilities correspond to the following table of counts (summing to 100):

```{r cab data}
HitAndRun <- as.table(array(c(12, 17, 3, 68), 
                            dim = c(2,2),
                            dimnames = list(
                                Cab = c("Blue", "Green"), 
                                Witness = c("Blue", "Green"))
                            )
                      )
```

Or, equivalently, as proportions:

```{r print table, echo=FALSE, message=FALSE, fig.align="center", fig.width=4, fig.height=3.5, out.width ="50%"}
knitr::kable(addmargins(prop.table(HitAndRun)))
```


Plotting this data as an eikosogram provides a picture of the probabilities/proportions exactly as given by the court room testimony:

```{r first eikosogram, echo=TRUE, message=FALSE, fig.align="center", fig.width=4, fig.height=3.5, out.width ="50%"}
eikos(y = "Witness", x = "Cab", data = HitAndRun, 
      bottomcol = "grey")
```

An examination of this eikosogram shows that it is faithful to the facts as described.  The horizontal or conditioning variate is the actual colour of cabs in the city --  15\%  blue cabs and 85\% green appear as the rectangle widths (the marginal probabilities marked along the top axis for each value of the conditioning variate).  

The vertical axes show the conditional probabilities according to the reliability of the eye witness.  The leftmost pair of rectangles represent the condition that the witness is shown a blue car; in this case, they correctly identify it as blue with probability 0.80 or 80\% of the time (height of bottom rectangle).  Similarly, the rightmost pair of rectangles represent the condition that the witness is presented a green coloured cab, in which case they will incorrectly say is blue with only a probability 0.2 or 20\% of the time (height of bottom rectangle) and will correctly identify it as green fully  80\% of the time (height of top rectangle).

Reading the eikosogram from left to right, the first vertical height of 0.8 for the darker grey bar at left is seen to be (reading left to right) the conditional probability that the witness says the cab is blue given that it is blue.  But is this the probability of interest?  Surely, in a court of law, the jurors should be interested in the probability that the accused is guilty, given the evidence presented.  Mathematically, this would be
\[ Pr \left( \mbox{Cab is blue} \given \mbox{Witness says it is blue} \right).
\]
Instead, the participants/jurors appear to have focused on
\[ Pr \left( \mbox{Witness says it is blue} \given \mbox{Cab is blue}  \right)
\]
which is not the relevant probability to determine guilt or innocence.


# The solution

The correct probability,
\[ Pr \left( \mbox{Cab is blue} \given \mbox{Witness says it is blue} \right),
\]
can of course be determined directly from the above eikosogram.  

The conditioning event, here that the witness said the cab was blue, corresponds to the two bottomost dark grey rectangles of that eikosogram.  

Considering only those rectangles, the ratio of the area of the leftmost to that of the rightmost gives the *odds* that the cab actually is blue to it actually being green.  Similarly, the ratio of the area of the leftmost dark grey rectangle to the sum of the areas of the two dark grey rectangles is the desired probability. 

Visual inspection suggests that this is less than $1/2$ since the left dark rectangle appears to have smaller area than the right dark rectangle.  It is at least clearly much less than $0.80$! Only the actual calculation will determine the value precisely.

## its picture

Fortunately, this value is trivially had if we simply flip the eikosogram on its side.  That is, swap the two variates changing the roles from response to conditioning variate and vice versa. 

The eikosogram with "Cab" as the response variate and "Witness" as the conditioning variate is just as easily produced.

```{r cab solution, echo=TRUE, message=FALSE, fig.align="center", fig.width=4, fig.height=3, out.width ="50%"}
eikos(y = "Cab", x = "Witness", data = HitAndRun, 
      bottomcol = "grey")
```

Note that comparison of this eikosogram with the previous shows that no probability has changed.  Both diagrams represent the same joint probability distribution. For example, note that matching areas between the two eikosograms is simply Bayes rule. All that has happened is that the joint distribution is factored differently.

The desired probability, is much more easily read off the second diagram than the first.  Its value (from the right hand vertical axis) is
\[ Pr \left( \mbox{Cab is blue} \given \mbox{Witness says it is blue} \right) = 0.41 .
\]
This is nearly half the probability that Kahneman and Tversky found to be the most popular value suggested by the participants!

We also see that had the witness said the cab was green, the probability that it is indeed green is $1 - 0.04 = 0.96$.  If the witness is consistently correct 80\% of the time, because of the distribution of cabs of both colours across the city, the cab will indeed be blue if the witness says so only 41\% of the time but will be green nearly always (96\% of the time) if the witness identifies it as green!

Now that's interesting...

# More problems and paradoxes

For other probability problems and paradoxes using eikosograms, see @eikosExamples03.

# References
