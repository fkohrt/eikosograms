<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Data Analysis • eikosograms</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Data Analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">eikosograms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DataAnalysis.html">Data Analysis</a>
    </li>
    <li>
      <a href="../articles/IndependenceExploration.html">Exploring Independence</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction to eikosograms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rwoldford/eikosograms">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Data Analysis</h1>
                        <h4 class="author">R. W. Oldford</h4>
            
            <h4 class="date">August 21, 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rwoldford/eikosograms/blob/master/vignettes/DataAnalysis.Rmd"><code>vignettes/DataAnalysis.Rmd</code></a></small>
      <div class="hidden name"><code>DataAnalysis.Rmd</code></div>

    </div>

    
    
<hr>
<p><span class="math inline">\(\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}\)</span> <span class="math inline">\(\renewcommand{\ve}[1]{\mathbf{#1}}\)</span> <span class="math inline">\(\renewcommand{\sv}[1]{\boldsymbol{#1}}\)</span> <span class="math inline">\(\renewcommand{\pop}[1]{\mathcal{#1}}\)</span> <span class="math inline">\(\renewcommand{\samp}[1]{\mathcal{#1}}\)</span> <span class="math inline">\(\renewcommand{\imply}{\Longrightarrow}\)</span> <span class="math inline">\(\renewcommand{\given}{~\vert~}\)</span> <span class="math inline">\(\renewcommand{\suchthat}{~:~}\)</span> <span class="math inline">\(\renewcommand{\widebar}[1]{\overline{#1}}\)</span> <span class="math inline">\(\renewcommand{\wig}[1]{\tilde{#1}}\)</span> <span class="math inline">\(\renewcommand{\bigwig}[1]{\widetilde{#1}}\)</span> <span class="math inline">\(\renewcommand{\field}[1]{\mathbb{#1}}\)</span> <span class="math inline">\(\renewcommand{\Reals}{\field{R}}\)</span> <span class="math inline">\(\renewcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}\)</span> <span class="math inline">\(\renewcommand{\size}[1]{\left\lvert {#1} \right\rvert}\)</span> <span class="math inline">\(\renewcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}\)</span> <span class="math inline">\(\renewcommand{\norm}[1]{\left|\left|{#1}\right|\right|}\)</span> <span class="math inline">\(\renewcommand{\intersect}{\cap}\)</span> <span class="math inline">\(\renewcommand{\union}{\cup}\)</span></p>
<p>The other vignettes emphasize the use of eikosograms in understanding probability and relations between categorical variates. Here, we just give a few example of the use of eikosograms in data analysis.</p>
<p>Because categorical data can present itself in a variety of forms (e.g. <code>tables</code>, <code>factors</code> in a data frame, etc.), the illustrations centre around different types of data structure</p>
<div id="tables" class="section level1">
<h1 class="hasAnchor">
<a href="#tables" class="anchor"></a>tables</h1>
<p>Contingency tables (multi-way tables or “data cubes”) are possibly the most common arrangement of categorical data. They are used, for example, in the introductory vignette.</p>
<p>Here, we present a simple analysis of the University of California (Berkeley) graduate school admissions.</p>
<p>Note that eikosograms are <code>grid</code> objects (<code><a href="../reference/eikos.html">eikos()</a></code> returns a <code>grob</code>) and so may be manipulated as any other. For example, several eikosograms could appear in the same display using <code><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange()</a></code> (from the <code>gridExtra</code> package).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(eikosograms)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gridExtra)</code></pre></div>
<p>University administrators were apparently alarmed (as they often are) when they looked at the numbers and saw the relationship between gender and admission rates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(Admit <span class="op">~</span><span class="st"> </span>Gender, <span class="dt">data =</span> UCBAdmissions, 
            <span class="dt">yaxs =</span> <span class="ot">FALSE</span>, <span class="dt">xaxs =</span> <span class="ot">FALSE</span>, 
            <span class="dt">draw =</span> <span class="ot">FALSE</span>)
e2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(Admit <span class="op">~</span><span class="st"> </span>Dept, <span class="dt">data =</span> UCBAdmissions,  
            <span class="dt">yaxs =</span> <span class="ot">FALSE</span>, <span class="dt">xaxs =</span> <span class="ot">FALSE</span>,
            <span class="dt">draw =</span> <span class="ot">FALSE</span>)
<span class="co"># Using the gridExtra package, draw these in a single plot</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/gridExtra/topics/arrangeGrob">grid.arrange</a></span>(e1, e2, <span class="dt">nrow =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="img/DataAnalysis/UCB2way.png" width="80%" style="display: block; margin: auto;"></p>
<p>At left we see that male applicants are admitted more frequently than female applicants, suggesting a possible gender bias to university administrators. At right, we see that some departments admit more applicants than others, suggesting some may be more difficult to get into than others.</p>
<p>When all three variates are considered together, the true story emerges</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(Admit <span class="op">~</span><span class="st">  </span>Gender <span class="op">+</span><span class="st"> </span>Dept, <span class="dt">data =</span> UCBAdmissions,  
      <span class="dt">yaxs =</span> <span class="ot">FALSE</span>, <span class="dt">xaxs =</span> <span class="ot">FALSE</span>, 
      <span class="dt">lock_aspect =</span> <span class="ot">FALSE</span>, 
      <span class="dt">xlab_rot =</span> <span class="dv">90</span>, <span class="dt">xvals_size =</span> <span class="dv">8</span>,
      <span class="dt">ispace =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">bottom =</span> <span class="dv">15</span>))</code></pre></div>
<p><img src="img/DataAnalysis/UCB3way.png" width="80%" style="display: block; margin: auto;"> In all departments but C and E (which are near equal), a greater proportion of female applicants were accepted than males. This is a famous example of Simpson’s paradox. As can be seen perhaps more clearly from the following eikosogram, the reason for the apparent favouritism towards male applicants occured only because a great many more males than females applied to those departments with the highest admission rates. And in those departments (A and B) the admission rates for females was much higher than that for males!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(Gender <span class="op">~</span><span class="st"> </span>Dept, <span class="dt">data =</span> UCBAdmissions, <span class="dt">yprobs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>), <span class="dt">xaxs =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="img/DataAnalysis/UCBAdmissions.png" width="50%" style="display: block; margin: auto;"> Female applicants outnumber male applicants only in departments C and E.</p>
</div>
<div id="cross-tabulation" class="section level1">
<h1 class="hasAnchor">
<a href="#cross-tabulation" class="anchor"></a>cross tabulation</h1>
<p>Sometimes the counts appear as a column in a spreadsheet (or <code>data.frame</code>). Here we consider the counts for habitat type of adult male <strong>anolis</strong> lizards from Bimini. These are taken frpm <span class="citation">Schoener (1968)</span> and are saved here as a text file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lizards &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.table</a></span>(<span class="st">"data/AnolisLizards.txt"</span>, <span class="dt">header=</span><span class="ot">TRUE</span>)
lizards</code></pre></div>
<pre><code>##       species perch_height_ft perch_diameter_inches count
## 1      sagrei            &gt;= 3               &lt;= 4.25    15
## 2      sagrei            &gt;= 3                &gt; 4.25    18
## 3      sagrei             &lt; 3               &lt;= 4.25    48
## 4      sagrei             &lt; 3                &gt; 4.25    84
## 5 augusticeps            &gt;= 3               &lt;= 4.25    21
## 6 augusticeps            &gt;= 3                &gt; 4.25     1
## 7 augusticeps             &lt; 3               &lt;= 4.25     3
## 8 augusticeps             &lt; 3                &gt; 4.25     2</code></pre>
<p>As can be seen, there are three categorical variates, the <code>species</code> of the <em>anolis</em> lizard, the height (in feet) of where it was observed, and the diameter (in inches) of the branch on which it was perched. The number of such observations is given as the fourth variable, <code>count</code>.</p>
<p>For example, this can be a very convenient form of the data for selecting subsets, particularly for large data sets. Here we might separate the two species:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sagrei &lt;-<span class="st"> </span>lizards[lizards<span class="op">$</span>species <span class="op">==</span><span class="st"> "sagrei"</span>, <span class="op">-</span><span class="dv">1</span>]
augusticeps &lt;-<span class="st"> </span>lizards[lizards<span class="op">$</span>species <span class="op">==</span><span class="st"> "augusticeps"</span>, <span class="op">-</span><span class="dv">1</span>]</code></pre></div>
<p>Following <span class="citation">Fienberg (1980)</span>, we might first consider the relation between perch height and perch diameter for the <code>sagrei</code> species. To look at the eikosigram, these need to be turned into a table using the cross-tabulation <code><a href="https://www.rdocumentation.org/packages/stats/topics/xtabs">xtabs()</a></code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sagreiTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/xtabs">xtabs</a></span>(count <span class="op">~</span><span class="st"> </span>perch_height_ft <span class="op">+</span><span class="st"> </span>perch_diameter_inches, <span class="dt">data =</span> sagrei)</code></pre></div>
<p>and draw it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(perch_height_ft <span class="op">~</span><span class="st"> </span>perch_diameter_inches, <span class="dt">data =</span> sagreiTable, 
      <span class="dt">main =</span> <span class="st">"Habitat of adult male anolis sagrei lizards"</span>)</code></pre></div>
<p><img src="img/DataAnalysis/sagreiPerch.png" width="50%" style="display: block; margin: auto;"></p>
<p>The two heights of the bars are very nearly the same, suggesting that the height and the diameter of the perch might be independent variates for the <em>anolis sagrei</em> lizard of Bimini. Indeed, a formal test of independence gives no evidence against this hypothesis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/chisq.test">chisq.test</a></span>(sagreiTable)</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test with Yates' continuity correction
## 
## data:  sagreiTable
## X-squared = 0.57934, df = 1, p-value = 0.4466</code></pre>
<p>Now, were we to consider the same for <em>anolis augusticeps</em>, first the table</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">augusticepsTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/xtabs">xtabs</a></span>(count <span class="op">~</span><span class="st"> </span>perch_height_ft <span class="op">+</span><span class="st"> </span>perch_diameter_inches, <span class="dt">data =</span> augusticeps)</code></pre></div>
<p>and then its probability picture</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(perch_height_ft <span class="op">~</span><span class="st"> </span>perch_diameter_inches, <span class="dt">data =</span> augusticepsTable, 
      <span class="dt">main =</span> <span class="st">"Habitat of adult male anolis augusticeps lizards"</span>)</code></pre></div>
<p><img src="img/DataAnalysis/augusticepsPerch.png" width="50%" style="display: block; margin: auto;"></p>
<p>Clearly, the bars do not appear to be of equal height. That the eikosogram is not even nearly flat is <strong>suggestive</strong> that perch height and diameter are not independent for the species <em>anolis augusticeps</em>. However, there needs to be some <strong>caution</strong> exercised here. As with <em>anolis sagrei</em>, one needs to formally test the hypothesis of independence for a sample of counts. There are so few observations (1,2, and 3 in three cells and 21 in the largest) that any formal test will also show <strong>no evidence against the hypothesis of independence</strong> in this case. (This includes a line up test using eikosograms as the display for each generated data set!)</p>
<p>All three variates could be examined at once by producing the three way cross-classified table and the corresponding eikosograms. Following <span class="citation">Fienberg (1980)</span>, we first consider the relation between perch height and perch diameter for the <code>sagrei</code> species of the anolis lizard. The table</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lizardsTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/xtabs">xtabs</a></span>(count <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>perch_height_ft <span class="op">+</span><span class="st"> </span>perch_diameter_inches,
                      <span class="dt">data =</span> lizards)</code></pre></div>
<p>and its picture</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(species <span class="op">~</span><span class="st"> </span>. , <span class="dt">data =</span> lizardsTable, <span class="dt">lock_aspect =</span> <span class="ot">FALSE</span>, <span class="dt">yprobs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="fl">0.1</span>))</code></pre></div>
<p><img src="img/DataAnalysis/lizards3way.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div id="listings-data-frame-rows" class="section level1">
<h1 class="hasAnchor">
<a href="#listings-data-frame-rows" class="anchor"></a>listings (data frame rows)</h1>
<p>The final way in which categorical data is commonly presented is in a listing (e.g. <code>data.frame</code>) where each row corresponds to a single occurrence of that combination of values for the variates.</p>
<p>For example, consider the <code>mtcars</code> dataset in <code>R</code>, the first few rows of which are</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Although all of these variables are numeric, it is clear that many of them could be treated as categorical. For example, <code>vs</code> is a simple indicator variable indicating the shape of the engine block – <code>0</code> if it the cylinders are arranged in a “V” pattern and 1 if they are aligned in a straight line. This variable might instead have been represented as a <code>factor</code>. The same could be said of the variable <code>am</code> which is also a binary variable indicating <code>0</code> for an automatic transmission and 1 for a manual.</p>
<p>To make the point, we replace these two numeric variables by factors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars<span class="op">$</span>vs &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(mtcars<span class="op">$</span>vs, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"V-shaped"</span>, <span class="st">"straight"</span>))
mtcars<span class="op">$</span>am &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(mtcars<span class="op">$</span>am, <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"automatic"</span>, <span class="st">"manual"</span>))</code></pre></div>
<p>so that the first few rows of <code>mtcars</code> now look like</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="left">vs</th>
<th align="left">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="left">V-shaped</td>
<td align="left">manual</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="left">V-shaped</td>
<td align="left">manual</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="left">straight</td>
<td align="left">manual</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="left">straight</td>
<td align="left">automatic</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="left">V-shaped</td>
<td align="left">automatic</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="left">straight</td>
<td align="left">automatic</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>The eikosogram of these two factors can be compared without contructing a table; <code><a href="../reference/eikos.html">eikos()</a></code> does the counting of matching rows to produce the picture.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(am <span class="op">~</span><span class="st"> </span>vs, <span class="dt">data =</span> mtcars)</code></pre></div>
<p><img src="img/DataAnalysis/amvs.png" width="50%" style="display: block; margin: auto;"></p>
<p>This matching <strong>does not depend on the variables being factors</strong>. Any variable in a <code>data.frame</code> would do and would be treated as if it were categorical. In the <code>mtcars</code> data, there are several variables that are effectively <em>ordinal categorical</em> variates, namely <code>cyl</code>, <code>gear</code>, and <code>carb</code>.</p>
<p>These too could be explored using eikosograms. Transmission type versus number of cylinders</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(am <span class="op">~</span><span class="st"> </span>cyl, <span class="dt">data =</span> mtcars)</code></pre></div>
<p><img src="img/DataAnalysis/amordinal1.png" width="40%" style="display: block; margin: auto;"></p>
<p>and number of forward gears versus number of cylinders</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(gear <span class="op">~</span><span class="st"> </span>cyl, <span class="dt">data =</span> mtcars)</code></pre></div>
<p><img src="img/DataAnalysis/ordinal2.png" width="37%" style="display: block; margin: auto;"></p>
</div>
<div id="fitted-models" class="section level1">
<h1 class="hasAnchor">
<a href="#fitted-models" class="anchor"></a>fitted models</h1>
<p>There are numerous types of models that can be fitted to categorical data. One of the more popular are generalized linear models. For example, we might fit a log-linear model to the <code>lizards</code> habitat data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fittedModel &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(count <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>perch_height_ft, 
                   <span class="dt">family=</span><span class="st">"poisson"</span>, 
                   <span class="dt">data =</span> lizards)</code></pre></div>
<p>This is a “main effects” only model and contains no interaction term. To see what this model asserts about the relationship between <code>species</code> and <code>perch_height</code>, we need to use the <code>fitted.values</code> from the model as the <strong>expected counts</strong>. A new <code>data.frame</code> is constructed from the fit as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Can simply append the fitted values to the lizards to get a new data frame</span>
lizardsFit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(lizards,  <span class="dt">fit =</span> fittedModel<span class="op">$</span>fitted.values)
<span class="co"># and create the table</span>
fitTable &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/xtabs">xtabs</a></span>(fit <span class="op">~</span><span class="st">  </span>species <span class="op">+</span><span class="st"> </span>perch_height_ft,  <span class="dt">data=</span>lizardsFit)</code></pre></div>
<p>The eikosogram corresponding to the model fitted to these two variables is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eikos.html">eikos</a></span>(<span class="st">"species"</span>, <span class="st">"perch_height_ft"</span>, <span class="dt">data =</span> fitTable)</code></pre></div>
<p><img src="img/DataAnalysis/poisson1.png" width="60%" style="display: block; margin: auto;"> from which we can see that the model is asserting that <code>species</code> and <code>perch_height_ft</code> are independently distributed. In log-linear modelling, independence and conditional independence are asserted by the interaction terms which appear in these (hierarchical) models.</p>
<p>For example, the following model forces independence between <code>perch_height_ft</code> and <code>perch_diameter_inches</code>, <em>conditional on</em> <code>species</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fittedModel3way &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(count <span class="op">~</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>perch_height_ft <span class="op">+</span><span class="st"> </span>perch_diameter_inches <span class="op">+</span>
<span class="st">                           </span>perch_height_ft <span class="op">*</span><span class="st"> </span>species <span class="op">+</span><span class="st"> </span>
<span class="st">                           </span>perch_diameter_inches <span class="op">*</span><span class="st"> </span>species, 
                       <span class="dt">family=</span><span class="st">"poisson"</span>, 
                       <span class="dt">data =</span> lizards)</code></pre></div>
<p>The absence of the terms <code>perch_height_ft * perch_diameter_inches</code> and <code>perch_height_ft * perch_diameter_inches * species</code> means that when <code>species</code> is held fixed, the terms <code>perch_height_ft</code> and <code>perch_diameter_inches</code> are sepable in the model. Hence they are conditionally independent. As before, we can see this by viewing the eikosogram for the fitted values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Can simply append the fitted values to the lizards to get a new data frame</span>
lizardsFit3way &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(lizards,  <span class="dt">fit =</span> fittedModel3way<span class="op">$</span>fitted.values)
<span class="co"># and create the table</span>
fitTable3way &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/xtabs">xtabs</a></span>(fit <span class="op">~</span><span class="st">  </span>species <span class="op">+</span><span class="st"> </span>perch_height_ft <span class="op">+</span><span class="st"> </span>perch_diameter_inches,  <span class="dt">data=</span>lizardsFit3way)
<span class="co"># and show the eikosograms</span>
<span class="kw"><a href="../reference/eikos.html">eikos</a></span>(<span class="dt">y =</span> <span class="st">"perch_diameter_inches"</span>, <span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"perch_height_ft"</span>, <span class="st">"species"</span>), <span class="dt">data =</span> fitTable3way,
      <span class="dt">xlab_rot =</span> <span class="dv">30</span>)</code></pre></div>
<p><img src="img/DataAnalysis/poisson2.png" width="60%" style="display: block; margin: auto;"> and the conditional independence asserted by the model becomes obvious. See also <a href="../inst/doc/IndependenceExploration.html">vignette on independence exploration</a>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>references</h1>
<div id="refs" class="references">
<div id="ref-fienberg80">
<p>Fienberg, Stephen E. 1980. <em>The Analysis of Cross-Classified Categorical Data</em>. 2nd ed. MIT Press.</p>
</div>
<div id="ref-Schoener_1968">
<p>Schoener, Thomas W. 1968. “The Anolis Lizards of Bimini: Resource Partitioning in a Complex Fauna.” <em>Ecology</em> 49 (4). Wiley: 704–26. doi:<a href="https://doi.org/10.2307/1935534">10.2307/1935534</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#tables">tables</a></li>
      <li><a href="#cross-tabulation">cross tabulation</a></li>
      <li><a href="#listings-data-frame-rows">listings (data frame rows)</a></li>
      <li><a href="#fitted-models">fitted models</a></li>
      <li><a href="#references">references</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Wayne Oldford, Erle Holgersen, Ben Lafreniere, Tianlu Zhu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
